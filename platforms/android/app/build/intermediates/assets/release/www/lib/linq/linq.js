!function(root,undefined){var Functions={Identity:function(x){return x},True:function(){return!0},Blank:function(){}},Types_Boolean=typeof!0,Types_Number="number",Types_String="string",Types_Object=typeof{},Types_Undefined="undefined",Types_Function="function",funcCache={"":Functions.Identity},Utils={createLambda:function(expression){if(null==expression)return Functions.Identity;if(typeof expression===Types_String){var f=funcCache[expression];if(null!=f)return f;if(-1===expression.indexOf("=>")){for(var match,regexp=new RegExp("[$]+","g"),maxLength=0;null!=(match=regexp.exec(expression));){var paramNumber=match[0].length;maxLength<paramNumber&&(maxLength=paramNumber)}for(var argArray=[],i=1;i<=maxLength;i++){for(var dollar="",j=0;j<i;j++)dollar+="$";argArray.push(dollar)}var args=Array.prototype.join.call(argArray,",");return f=new Function(args,"return "+expression),funcCache[expression]=f}var expr=expression.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return f=new Function(expr[1],"return "+expr[2]),funcCache[expression]=f}return expression},isIEnumerable:function(obj){if(typeof Enumerator!==Types_Undefined)try{return new Enumerator(obj),!0}catch(e){}return!1},defineProperty:null!=Object.defineProperties?function(target,methodName,value){Object.defineProperty(target,methodName,{enumerable:!1,configurable:!0,writable:!0,value:value})}:function(target,methodName,value){target[methodName]=value},compare:function(a,b){return a===b?0:b<a?1:-1},dispose:function(obj){null!=obj&&obj.dispose()}},State_Before=0,State_Running=1,State_After=2,IEnumerator=function(initialize,tryGetNext,dispose){var yielder=new Yielder,state=State_Before;this.current=yielder.current,this.moveNext=function(){try{switch(state){case State_Before:state=State_Running,initialize();case State_Running:return!!tryGetNext.apply(yielder)||(this.dispose(),!1);case State_After:return!1}}catch(e){throw this.dispose(),e}},this.dispose=function(){if(state==State_Running)try{dispose()}finally{state=State_After}}},Yielder=function(){var current=null;this.current=function(){return current},this.yieldReturn=function(value){return current=value,!0},this.yieldBreak=function(){return!1}},Enumerable=function(getEnumerator){this.getEnumerator=getEnumerator};(Enumerable.Utils={}).createLambda=function(expression){return Utils.createLambda(expression)},Enumerable.Utils.createEnumerable=function(getEnumerator){return new Enumerable(getEnumerator)},Enumerable.Utils.createEnumerator=function(initialize,tryGetNext,dispose){return new IEnumerator(initialize,tryGetNext,dispose)},Enumerable.Utils.extendTo=function(type){var enumerableProto,typeProto=type.prototype;for(var methodName in type===Array?(enumerableProto=ArrayEnumerable.prototype,Utils.defineProperty(typeProto,"getSource",function(){return this})):(enumerableProto=Enumerable.prototype,Utils.defineProperty(typeProto,"getEnumerator",function(){return Enumerable.from(this).getEnumerator()})),enumerableProto){var func=enumerableProto[methodName];typeProto[methodName]!=func&&(null!=typeProto[methodName]&&typeProto[methodName+="ByLinq"]==func||func instanceof Function&&Utils.defineProperty(typeProto,methodName,func))}},Enumerable.choice=function(){var args=arguments;return new Enumerable(function(){return new IEnumerator(function(){args=args[0]instanceof Array?args[0]:null!=args[0].getEnumerator?args[0].toArray():args},function(){return this.yieldReturn(args[Math.floor(Math.random()*args.length)])},Functions.Blank)})},Enumerable.cycle=function(){var args=arguments;return new Enumerable(function(){var index=0;return new IEnumerator(function(){args=args[0]instanceof Array?args[0]:null!=args[0].getEnumerator?args[0].toArray():args},function(){return index>=args.length&&(index=0),this.yieldReturn(args[index++])},Functions.Blank)})},Enumerable.empty=function(){return new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return!1},Functions.Blank)})},Enumerable.from=function(obj){if(null==obj)return Enumerable.empty();if(obj instanceof Enumerable)return obj;if(typeof obj==Types_Number||typeof obj==Types_Boolean)return Enumerable.repeat(obj,1);if(typeof obj==Types_String)return new Enumerable(function(){var index=0;return new IEnumerator(Functions.Blank,function(){return index<obj.length&&this.yieldReturn(obj.charAt(index++))},Functions.Blank)});if(typeof obj!=Types_Function){if(typeof obj.length==Types_Number)return new ArrayEnumerable(obj);if(!(obj instanceof Object)&&Utils.isIEnumerable(obj))return new Enumerable(function(){var enumerator,isFirst=!0;return new IEnumerator(function(){enumerator=new Enumerator(obj)},function(){return isFirst?isFirst=!1:enumerator.moveNext(),!enumerator.atEnd()&&this.yieldReturn(enumerator.item())},Functions.Blank)});if(typeof Windows===Types_Object&&typeof obj.first===Types_Function)return new Enumerable(function(){var enumerator,isFirst=!0;return new IEnumerator(function(){enumerator=obj.first()},function(){return isFirst?isFirst=!1:enumerator.moveNext(),enumerator.hasCurrent?this.yieldReturn(enumerator.current):this.yieldBreak()},Functions.Blank)})}return new Enumerable(function(){var array=[],index=0;return new IEnumerator(function(){for(var key in obj){var value=obj[key];value instanceof Function||!Object.prototype.hasOwnProperty.call(obj,key)||array.push({key:key,value:value})}},function(){return index<array.length&&this.yieldReturn(array[index++])},Functions.Blank)})},Enumerable.make=function(element){return Enumerable.repeat(element,1)},Enumerable.matches=function(input,pattern,flags){return null==flags&&(flags=""),pattern instanceof RegExp&&(flags+=pattern.ignoreCase?"i":"",flags+=pattern.multiline?"m":"",pattern=pattern.source),-1===flags.indexOf("g")&&(flags+="g"),new Enumerable(function(){var regex;return new IEnumerator(function(){regex=new RegExp(pattern,flags)},function(){var match=regex.exec(input);return!!match&&this.yieldReturn(match)},Functions.Blank)})},Enumerable.range=function(start,count,step){return null==step&&(step=1),new Enumerable(function(){var value,index=0;return new IEnumerator(function(){value=start-step},function(){return index++<count?this.yieldReturn(value+=step):this.yieldBreak()},Functions.Blank)})},Enumerable.rangeDown=function(start,count,step){return null==step&&(step=1),new Enumerable(function(){var value,index=0;return new IEnumerator(function(){value=start+step},function(){return index++<count?this.yieldReturn(value-=step):this.yieldBreak()},Functions.Blank)})},Enumerable.rangeTo=function(start,to,step){return null==step&&(step=1),new Enumerable(start<to?function(){var value;return new IEnumerator(function(){value=start-step},function(){var next=value+=step;return next<=to?this.yieldReturn(next):this.yieldBreak()},Functions.Blank)}:function(){var value;return new IEnumerator(function(){value=start+step},function(){var next=value-=step;return to<=next?this.yieldReturn(next):this.yieldBreak()},Functions.Blank)})},Enumerable.repeat=function(element,count){return null!=count?Enumerable.repeat(element).take(count):new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return this.yieldReturn(element)},Functions.Blank)})},Enumerable.repeatWithFinalize=function(initializer,finalizer){return initializer=Utils.createLambda(initializer),finalizer=Utils.createLambda(finalizer),new Enumerable(function(){var element;return new IEnumerator(function(){element=initializer()},function(){return this.yieldReturn(element)},function(){null!=element&&(finalizer(element),element=null)})})},Enumerable.generate=function(func,count){return null!=count?Enumerable.generate(func).take(count):(func=Utils.createLambda(func),new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return this.yieldReturn(func())},Functions.Blank)}))},Enumerable.toInfinity=function(start,step){return null==start&&(start=0),null==step&&(step=1),new Enumerable(function(){var value;return new IEnumerator(function(){value=start-step},function(){return this.yieldReturn(value+=step)},Functions.Blank)})},Enumerable.toNegativeInfinity=function(start,step){return null==start&&(start=0),null==step&&(step=1),new Enumerable(function(){var value;return new IEnumerator(function(){value=start+step},function(){return this.yieldReturn(value-=step)},Functions.Blank)})},Enumerable.unfold=function(seed,func){return func=Utils.createLambda(func),new Enumerable(function(){var value,isFirst=!0;return new IEnumerator(Functions.Blank,function(){return isFirst?(isFirst=!1,value=seed):value=func(value),this.yieldReturn(value)},Functions.Blank)})},Enumerable.defer=function(enumerableFactory){return new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=Enumerable.from(enumerableFactory()).getEnumerator()},function(){return enumerator.moveNext()?this.yieldReturn(enumerator.current()):this.yieldBreak()},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.traverseBreadthFirst=function(func,resultSelector){var source=this;return func=Utils.createLambda(func),resultSelector=Utils.createLambda(resultSelector),new Enumerable(function(){var enumerator,nestLevel=0,buffer=[];return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;;){if(enumerator.moveNext())return buffer.push(enumerator.current()),this.yieldReturn(resultSelector(enumerator.current(),nestLevel));var next=Enumerable.from(buffer).selectMany(function(x){return func(x)});if(!next.any())return!1;nestLevel++,buffer=[],Utils.dispose(enumerator),enumerator=next.getEnumerator()}},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.traverseDepthFirst=function(func,resultSelector){var source=this;return func=Utils.createLambda(func),resultSelector=Utils.createLambda(resultSelector),new Enumerable(function(){var enumerator,enumeratorStack=[];return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;;){if(enumerator.moveNext()){var value=resultSelector(enumerator.current(),enumeratorStack.length);return enumeratorStack.push(enumerator),enumerator=Enumerable.from(func(enumerator.current())).getEnumerator(),this.yieldReturn(value)}if(enumeratorStack.length<=0)return!1;Utils.dispose(enumerator),enumerator=enumeratorStack.pop()}},function(){try{Utils.dispose(enumerator)}finally{Enumerable.from(enumeratorStack).forEach(function(s){s.dispose()})}})})},Enumerable.prototype.flatten=function(){var source=this;return new Enumerable(function(){var enumerator,middleEnumerator=null;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;;){if(null!=middleEnumerator){if(middleEnumerator.moveNext())return this.yieldReturn(middleEnumerator.current());middleEnumerator=null}if(enumerator.moveNext()){if(enumerator.current()instanceof Array){Utils.dispose(middleEnumerator),middleEnumerator=Enumerable.from(enumerator.current()).selectMany(Functions.Identity).flatten().getEnumerator();continue}return this.yieldReturn(enumerator.current())}return!1}},function(){try{Utils.dispose(enumerator)}finally{Utils.dispose(middleEnumerator)}})})},Enumerable.prototype.pairwise=function(selector){var source=this;return selector=Utils.createLambda(selector),new Enumerable(function(){var enumerator;return new IEnumerator(function(){(enumerator=source.getEnumerator()).moveNext()},function(){var prev=enumerator.current();return!!enumerator.moveNext()&&this.yieldReturn(selector(prev,enumerator.current()))},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.scan=function(seed,func){var isUseSeed;null==func?(func=Utils.createLambda(seed),isUseSeed=!1):(func=Utils.createLambda(func),isUseSeed=!0);var source=this;return new Enumerable(function(){var enumerator,value,isFirst=!0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){if(isFirst){if(isFirst=!1,isUseSeed)return this.yieldReturn(value=seed);if(enumerator.moveNext())return this.yieldReturn(value=enumerator.current())}return!!enumerator.moveNext()&&this.yieldReturn(value=func(value,enumerator.current()))},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.select=function(selector){if((selector=Utils.createLambda(selector)).length<=1)return new WhereSelectEnumerable(this,null,selector);var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return!!enumerator.moveNext()&&this.yieldReturn(selector(enumerator.current(),index++))},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.selectMany=function(collectionSelector,resultSelector){var source=this;return collectionSelector=Utils.createLambda(collectionSelector),null==resultSelector&&(resultSelector=function(a,b){return b}),resultSelector=Utils.createLambda(resultSelector),new Enumerable(function(){var enumerator,middleEnumerator=void 0,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){if(void 0===middleEnumerator&&!enumerator.moveNext())return!1;do{if(null==middleEnumerator){var middleSeq=collectionSelector(enumerator.current(),index++);middleEnumerator=Enumerable.from(middleSeq).getEnumerator()}if(middleEnumerator.moveNext())return this.yieldReturn(resultSelector(enumerator.current(),middleEnumerator.current()));Utils.dispose(middleEnumerator),middleEnumerator=null}while(enumerator.moveNext());return!1},function(){try{Utils.dispose(enumerator)}finally{Utils.dispose(middleEnumerator)}})})},Enumerable.prototype.where=function(predicate){if((predicate=Utils.createLambda(predicate)).length<=1)return new WhereEnumerable(this,predicate);var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();)if(predicate(enumerator.current(),index++))return this.yieldReturn(enumerator.current());return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.choose=function(selector){selector=Utils.createLambda(selector);var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();){var result=selector(enumerator.current(),index++);if(null!=result)return this.yieldReturn(result)}return this.yieldBreak()},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.ofType=function(type){var typeName;switch(type){case Number:typeName=Types_Number;break;case String:typeName=Types_String;break;case Boolean:typeName=Types_Boolean;break;case Function:typeName=Types_Function;break;default:typeName=null}return null===typeName?this.where(function(x){return x instanceof type}):this.where(function(x){return typeof x===typeName})},Enumerable.prototype.zip=function(){var args=arguments,selector=Utils.createLambda(arguments[arguments.length-1]),source=this;if(2==arguments.length){var second=arguments[0];return new Enumerable(function(){var firstEnumerator,secondEnumerator,index=0;return new IEnumerator(function(){firstEnumerator=source.getEnumerator(),secondEnumerator=Enumerable.from(second).getEnumerator()},function(){return!(!firstEnumerator.moveNext()||!secondEnumerator.moveNext())&&this.yieldReturn(selector(firstEnumerator.current(),secondEnumerator.current(),index++))},function(){try{Utils.dispose(firstEnumerator)}finally{Utils.dispose(secondEnumerator)}})})}return new Enumerable(function(){var enumerators,index=0;return new IEnumerator(function(){var array=Enumerable.make(source).concat(Enumerable.from(args).takeExceptLast().select(Enumerable.from)).select(function(x){return x.getEnumerator()}).toArray();enumerators=Enumerable.from(array)},function(){if(enumerators.all(function(x){return x.moveNext()})){var array=enumerators.select(function(x){return x.current()}).toArray();return array.push(index++),this.yieldReturn(selector.apply(null,array))}return this.yieldBreak()},function(){Enumerable.from(enumerators).forEach(Utils.dispose)})})},Enumerable.prototype.merge=function(){var args=arguments,source=this;return new Enumerable(function(){var enumerators,index=-1;return new IEnumerator(function(){enumerators=Enumerable.make(source).concat(Enumerable.from(args).select(Enumerable.from)).select(function(x){return x.getEnumerator()}).toArray()},function(){for(;0<enumerators.length;){index=index>=enumerators.length-1?0:index+1;var enumerator=enumerators[index];if(enumerator.moveNext())return this.yieldReturn(enumerator.current());enumerator.dispose(),enumerators.splice(index--,1)}return this.yieldBreak()},function(){Enumerable.from(enumerators).forEach(Utils.dispose)})})},Enumerable.prototype.join=function(inner,outerKeySelector,innerKeySelector,resultSelector,compareSelector){outerKeySelector=Utils.createLambda(outerKeySelector),innerKeySelector=Utils.createLambda(innerKeySelector),resultSelector=Utils.createLambda(resultSelector),compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var outerEnumerator,lookup,innerElements=null,innerCount=0;return new IEnumerator(function(){outerEnumerator=source.getEnumerator(),lookup=Enumerable.from(inner).toLookup(innerKeySelector,Functions.Identity,compareSelector)},function(){for(;;){if(null!=innerElements){var innerElement=innerElements[innerCount++];if(void 0!==innerElement)return this.yieldReturn(resultSelector(outerEnumerator.current(),innerElement));innerElement=null,innerCount=0}if(!outerEnumerator.moveNext())return!1;var key=outerKeySelector(outerEnumerator.current());innerElements=lookup.get(key).toArray()}},function(){Utils.dispose(outerEnumerator)})})},Enumerable.prototype.groupJoin=function(inner,outerKeySelector,innerKeySelector,resultSelector,compareSelector){outerKeySelector=Utils.createLambda(outerKeySelector),innerKeySelector=Utils.createLambda(innerKeySelector),resultSelector=Utils.createLambda(resultSelector),compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var enumerator=source.getEnumerator(),lookup=null;return new IEnumerator(function(){enumerator=source.getEnumerator(),lookup=Enumerable.from(inner).toLookup(innerKeySelector,Functions.Identity,compareSelector)},function(){if(enumerator.moveNext()){var innerElement=lookup.get(outerKeySelector(enumerator.current()));return this.yieldReturn(resultSelector(enumerator.current(),innerElement))}return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.all=function(predicate){predicate=Utils.createLambda(predicate);var result=!0;return this.forEach(function(x){if(!predicate(x))return result=!1}),result},Enumerable.prototype.any=function(predicate){predicate=Utils.createLambda(predicate);var enumerator=this.getEnumerator();try{if(0==arguments.length)return enumerator.moveNext();for(;enumerator.moveNext();)if(predicate(enumerator.current()))return!0;return!1}finally{Utils.dispose(enumerator)}},Enumerable.prototype.isEmpty=function(){return!this.any()},Enumerable.prototype.concat=function(){var source=this;if(1==arguments.length){var second=arguments[0];return new Enumerable(function(){var firstEnumerator,secondEnumerator;return new IEnumerator(function(){firstEnumerator=source.getEnumerator()},function(){if(null==secondEnumerator){if(firstEnumerator.moveNext())return this.yieldReturn(firstEnumerator.current());secondEnumerator=Enumerable.from(second).getEnumerator()}return!!secondEnumerator.moveNext()&&this.yieldReturn(secondEnumerator.current())},function(){try{Utils.dispose(firstEnumerator)}finally{Utils.dispose(secondEnumerator)}})})}var args=arguments;return new Enumerable(function(){var enumerators;return new IEnumerator(function(){enumerators=Enumerable.make(source).concat(Enumerable.from(args).select(Enumerable.from)).select(function(x){return x.getEnumerator()}).toArray()},function(){for(;0<enumerators.length;){var enumerator=enumerators[0];if(enumerator.moveNext())return this.yieldReturn(enumerator.current());enumerator.dispose(),enumerators.splice(0,1)}return this.yieldBreak()},function(){Enumerable.from(enumerators).forEach(Utils.dispose)})})},Enumerable.prototype.insert=function(index,second){var source=this;return new Enumerable(function(){var firstEnumerator,secondEnumerator,count=0,isEnumerated=!1;return new IEnumerator(function(){firstEnumerator=source.getEnumerator(),secondEnumerator=Enumerable.from(second).getEnumerator()},function(){return count==index&&secondEnumerator.moveNext()?(isEnumerated=!0,this.yieldReturn(secondEnumerator.current())):firstEnumerator.moveNext()?(count++,this.yieldReturn(firstEnumerator.current())):!(isEnumerated||!secondEnumerator.moveNext())&&this.yieldReturn(secondEnumerator.current())},function(){try{Utils.dispose(firstEnumerator)}finally{Utils.dispose(secondEnumerator)}})})},Enumerable.prototype.alternate=function(alternateValueOrSequence){var source=this;return new Enumerable(function(){var buffer,enumerator,alternateSequence,alternateEnumerator;return new IEnumerator(function(){alternateSequence=alternateValueOrSequence instanceof Array||null!=alternateValueOrSequence.getEnumerator?Enumerable.from(Enumerable.from(alternateValueOrSequence).toArray()):Enumerable.make(alternateValueOrSequence),(enumerator=source.getEnumerator()).moveNext()&&(buffer=enumerator.current())},function(){for(;;){if(null!=alternateEnumerator){if(alternateEnumerator.moveNext())return this.yieldReturn(alternateEnumerator.current());alternateEnumerator=null}if(null!=buffer||!enumerator.moveNext()){if(null!=buffer){var retVal=buffer;return buffer=null,this.yieldReturn(retVal)}return this.yieldBreak()}buffer=enumerator.current(),alternateEnumerator=alternateSequence.getEnumerator()}},function(){try{Utils.dispose(enumerator)}finally{Utils.dispose(alternateEnumerator)}})})},Enumerable.prototype.contains=function(value,compareSelector){compareSelector=Utils.createLambda(compareSelector);var enumerator=this.getEnumerator();try{for(;enumerator.moveNext();)if(compareSelector(enumerator.current())===value)return!0;return!1}finally{Utils.dispose(enumerator)}},Enumerable.prototype.defaultIfEmpty=function(defaultValue){var source=this;return void 0===defaultValue&&(defaultValue=null),new Enumerable(function(){var enumerator,isFirst=!0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return enumerator.moveNext()?(isFirst=!1,this.yieldReturn(enumerator.current())):!!isFirst&&(isFirst=!1,this.yieldReturn(defaultValue))},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.distinct=function(compareSelector){return this.except(Enumerable.empty(),compareSelector)},Enumerable.prototype.distinctUntilChanged=function(compareSelector){compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var enumerator,compareKey,initial;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();){var key=compareSelector(enumerator.current());if(initial)return initial=!1,compareKey=key,this.yieldReturn(enumerator.current());if(compareKey!==key)return compareKey=key,this.yieldReturn(enumerator.current())}return this.yieldBreak()},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.except=function(second,compareSelector){compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var enumerator,keys;return new IEnumerator(function(){enumerator=source.getEnumerator(),keys=new Dictionary(compareSelector),Enumerable.from(second).forEach(function(key){keys.add(key)})},function(){for(;enumerator.moveNext();){var current=enumerator.current();if(!keys.contains(current))return keys.add(current),this.yieldReturn(current)}return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.intersect=function(second,compareSelector){compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var enumerator,keys,outs;return new IEnumerator(function(){enumerator=source.getEnumerator(),keys=new Dictionary(compareSelector),Enumerable.from(second).forEach(function(key){keys.add(key)}),outs=new Dictionary(compareSelector)},function(){for(;enumerator.moveNext();){var current=enumerator.current();if(!outs.contains(current)&&keys.contains(current))return outs.add(current),this.yieldReturn(current)}return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.sequenceEqual=function(second,compareSelector){compareSelector=Utils.createLambda(compareSelector);var firstEnumerator=this.getEnumerator();try{var secondEnumerator=Enumerable.from(second).getEnumerator();try{for(;firstEnumerator.moveNext();)if(!secondEnumerator.moveNext()||compareSelector(firstEnumerator.current())!==compareSelector(secondEnumerator.current()))return!1;return!secondEnumerator.moveNext()}finally{Utils.dispose(secondEnumerator)}}finally{Utils.dispose(firstEnumerator)}},Enumerable.prototype.union=function(second,compareSelector){compareSelector=Utils.createLambda(compareSelector);var source=this;return new Enumerable(function(){var firstEnumerator,secondEnumerator,keys;return new IEnumerator(function(){firstEnumerator=source.getEnumerator(),keys=new Dictionary(compareSelector)},function(){var current;if(void 0===secondEnumerator){for(;firstEnumerator.moveNext();)if(current=firstEnumerator.current(),!keys.contains(current))return keys.add(current),this.yieldReturn(current);secondEnumerator=Enumerable.from(second).getEnumerator()}for(;secondEnumerator.moveNext();)if(current=secondEnumerator.current(),!keys.contains(current))return keys.add(current),this.yieldReturn(current);return!1},function(){try{Utils.dispose(firstEnumerator)}finally{Utils.dispose(secondEnumerator)}})})},Enumerable.prototype.orderBy=function(keySelector){return new OrderedEnumerable(this,keySelector,!1)},Enumerable.prototype.orderByDescending=function(keySelector){return new OrderedEnumerable(this,keySelector,!0)},Enumerable.prototype.reverse=function(){var source=this;return new Enumerable(function(){var buffer,index;return new IEnumerator(function(){buffer=source.toArray(),index=buffer.length},function(){return 0<index&&this.yieldReturn(buffer[--index])},Functions.Blank)})},Enumerable.prototype.shuffle=function(){var source=this;return new Enumerable(function(){var buffer;return new IEnumerator(function(){buffer=source.toArray()},function(){if(0<buffer.length){var i=Math.floor(Math.random()*buffer.length);return this.yieldReturn(buffer.splice(i,1)[0])}return!1},Functions.Blank)})},Enumerable.prototype.weightedSample=function(weightSelector){weightSelector=Utils.createLambda(weightSelector);var source=this;return new Enumerable(function(){var sortedByBound,totalWeight=0;return new IEnumerator(function(){sortedByBound=source.choose(function(x){var weight=weightSelector(x);return weight<=0?null:{value:x,bound:totalWeight+=weight}}).toArray()},function(){if(0<sortedByBound.length){for(var draw=Math.floor(Math.random()*totalWeight)+1,lower=-1,upper=sortedByBound.length;1<upper-lower;){var index=Math.floor((lower+upper)/2);sortedByBound[index].bound>=draw?upper=index:lower=index}return this.yieldReturn(sortedByBound[upper].value)}return this.yieldBreak()},Functions.Blank)})},Enumerable.prototype.groupBy=function(keySelector,elementSelector,resultSelector,compareSelector){var source=this;return keySelector=Utils.createLambda(keySelector),elementSelector=Utils.createLambda(elementSelector),null!=resultSelector&&(resultSelector=Utils.createLambda(resultSelector)),compareSelector=Utils.createLambda(compareSelector),new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=source.toLookup(keySelector,elementSelector,compareSelector).toEnumerable().getEnumerator()},function(){for(;enumerator.moveNext();)return null==resultSelector?this.yieldReturn(enumerator.current()):this.yieldReturn(resultSelector(enumerator.current().key(),enumerator.current()));return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.partitionBy=function(keySelector,elementSelector,resultSelector,compareSelector){var hasResultSelector,source=this;return keySelector=Utils.createLambda(keySelector),elementSelector=Utils.createLambda(elementSelector),compareSelector=Utils.createLambda(compareSelector),null==resultSelector?(hasResultSelector=!1,resultSelector=function(key,group){return new Grouping(key,group)}):(hasResultSelector=!0,resultSelector=Utils.createLambda(resultSelector)),new Enumerable(function(){var enumerator,key,compareKey,group=[];return new IEnumerator(function(){(enumerator=source.getEnumerator()).moveNext()&&(key=keySelector(enumerator.current()),compareKey=compareSelector(key),group.push(elementSelector(enumerator.current())))},function(){for(var hasNext;1==(hasNext=enumerator.moveNext())&&compareKey===compareSelector(keySelector(enumerator.current()));)group.push(elementSelector(enumerator.current()));if(0<group.length){var result=resultSelector(key,hasResultSelector?Enumerable.from(group):group);return hasNext?(key=keySelector(enumerator.current()),compareKey=compareSelector(key),group=[elementSelector(enumerator.current())]):group=[],this.yieldReturn(result)}return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.buffer=function(count){var source=this;return new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(var array=[],index=0;enumerator.moveNext();)if(array.push(enumerator.current()),++index>=count)return this.yieldReturn(array);return 0<array.length&&this.yieldReturn(array)},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.aggregate=function(seed,func,resultSelector){return(resultSelector=Utils.createLambda(resultSelector))(this.scan(seed,func,resultSelector).last())},Enumerable.prototype.average=function(selector){selector=Utils.createLambda(selector);var sum=0,count=0;return this.forEach(function(x){sum+=selector(x),++count}),sum/count},Enumerable.prototype.count=function(predicate){predicate=null==predicate?Functions.True:Utils.createLambda(predicate);var count=0;return this.forEach(function(x,i){predicate(x,i)&&++count}),count},Enumerable.prototype.max=function(selector){return null==selector&&(selector=Functions.Identity),this.select(selector).aggregate(function(a,b){return b<a?a:b})},Enumerable.prototype.min=function(selector){return null==selector&&(selector=Functions.Identity),this.select(selector).aggregate(function(a,b){return a<b?a:b})},Enumerable.prototype.maxBy=function(keySelector){return keySelector=Utils.createLambda(keySelector),this.aggregate(function(a,b){return keySelector(a)>keySelector(b)?a:b})},Enumerable.prototype.minBy=function(keySelector){return keySelector=Utils.createLambda(keySelector),this.aggregate(function(a,b){return keySelector(a)<keySelector(b)?a:b})},Enumerable.prototype.sum=function(selector){return null==selector&&(selector=Functions.Identity),this.select(selector).aggregate(0,function(a,b){return a+b})},Enumerable.prototype.elementAt=function(index){var value,found=!1;if(this.forEach(function(x,i){if(i==index)return value=x,!(found=!0)}),!found)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return value},Enumerable.prototype.elementAtOrDefault=function(index,defaultValue){var value;void 0===defaultValue&&(defaultValue=null);var found=!1;return this.forEach(function(x,i){if(i==index)return value=x,!(found=!0)}),found?value:defaultValue},Enumerable.prototype.first=function(predicate){if(null!=predicate)return this.where(predicate).first();var value,found=!1;if(this.forEach(function(x){return value=x,!(found=!0)}),!found)throw new Error("first:No element satisfies the condition.");return value},Enumerable.prototype.firstOrDefault=function(predicate,defaultValue){if(void 0!==predicate){if(typeof predicate===Types_Function||typeof Utils.createLambda(predicate)===Types_Function)return this.where(predicate).firstOrDefault(void 0,defaultValue);defaultValue=predicate}var value,found=!1;return this.forEach(function(x){return value=x,!(found=!0)}),found?value:defaultValue},Enumerable.prototype.last=function(predicate){if(null!=predicate)return this.where(predicate).last();var value,found=!1;if(this.forEach(function(x){found=!0,value=x}),!found)throw new Error("last:No element satisfies the condition.");return value},Enumerable.prototype.lastOrDefault=function(predicate,defaultValue){if(void 0!==predicate){if(typeof predicate===Types_Function||typeof Utils.createLambda(predicate)===Types_Function)return this.where(predicate).lastOrDefault(void 0,defaultValue);defaultValue=predicate}var value,found=!1;return this.forEach(function(x){found=!0,value=x}),found?value:defaultValue},Enumerable.prototype.single=function(predicate){if(null!=predicate)return this.where(predicate).single();var value,found=!1;if(this.forEach(function(x){if(found)throw new Error("single:sequence contains more than one element.");found=!0,value=x}),!found)throw new Error("single:No element satisfies the condition.");return value},Enumerable.prototype.singleOrDefault=function(predicate,defaultValue){if(void 0===defaultValue&&(defaultValue=null),null!=predicate)return this.where(predicate).singleOrDefault(null,defaultValue);var value,found=!1;return this.forEach(function(x){if(found)throw new Error("single:sequence contains more than one element.");found=!0,value=x}),found?value:defaultValue},Enumerable.prototype.skip=function(count){var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){for(enumerator=source.getEnumerator();index++<count&&enumerator.moveNext(););},function(){return!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.skipWhile=function(predicate){predicate=Utils.createLambda(predicate);var source=this;return new Enumerable(function(){var enumerator,index=0,isSkipEnd=!1;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;!isSkipEnd;){if(!enumerator.moveNext())return!1;if(!predicate(enumerator.current(),index++))return isSkipEnd=!0,this.yieldReturn(enumerator.current())}return!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.take=function(count){var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return!!(index++<count&&enumerator.moveNext())&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.takeWhile=function(predicate){predicate=Utils.createLambda(predicate);var source=this;return new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return!(!enumerator.moveNext()||!predicate(enumerator.current(),index++))&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.takeExceptLast=function(count){null==count&&(count=1);var source=this;return new Enumerable(function(){if(count<=0)return source.getEnumerator();var enumerator,q=[];return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();){if(q.length==count)return q.push(enumerator.current()),this.yieldReturn(q.shift());q.push(enumerator.current())}return!1},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.takeFromLast=function(count){if(count<=0||null==count)return Enumerable.empty();var source=this;return new Enumerable(function(){var sourceEnumerator,enumerator,q=[];return new IEnumerator(function(){sourceEnumerator=source.getEnumerator()},function(){for(;sourceEnumerator.moveNext();)q.length==count&&q.shift(),q.push(sourceEnumerator.current());return null==enumerator&&(enumerator=Enumerable.from(q).getEnumerator()),!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.indexOf=function(item){var found=null;return typeof item===Types_Function?this.forEach(function(x,i){if(item(x,i))return found=i,!1}):this.forEach(function(x,i){if(x===item)return found=i,!1}),null!==found?found:-1},Enumerable.prototype.lastIndexOf=function(item){var result=-1;return typeof item===Types_Function?this.forEach(function(x,i){item(x,i)&&(result=i)}):this.forEach(function(x,i){x===item&&(result=i)}),result},Enumerable.prototype.cast=function(){return this},Enumerable.prototype.asEnumerable=function(){return Enumerable.from(this)},Enumerable.prototype.toArray=function(){var array=[];return this.forEach(function(x){array.push(x)}),array},Enumerable.prototype.toLookup=function(keySelector,elementSelector,compareSelector){keySelector=Utils.createLambda(keySelector),elementSelector=Utils.createLambda(elementSelector),compareSelector=Utils.createLambda(compareSelector);var dict=new Dictionary(compareSelector);return this.forEach(function(x){var key=keySelector(x),element=elementSelector(x),array=dict.get(key);void 0!==array?array.push(element):dict.add(key,[element])}),new Lookup(dict)},Enumerable.prototype.toObject=function(keySelector,elementSelector){keySelector=Utils.createLambda(keySelector),elementSelector=Utils.createLambda(elementSelector);var obj={};return this.forEach(function(x){obj[keySelector(x)]=elementSelector(x)}),obj},Enumerable.prototype.toDictionary=function(keySelector,elementSelector,compareSelector){keySelector=Utils.createLambda(keySelector),elementSelector=Utils.createLambda(elementSelector),compareSelector=Utils.createLambda(compareSelector);var dict=new Dictionary(compareSelector);return this.forEach(function(x){dict.add(keySelector(x),elementSelector(x))}),dict},Enumerable.prototype.toJSONString=function(replacer,space){if(typeof JSON===Types_Undefined||null==JSON.stringify)throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),replacer,space)},Enumerable.prototype.toJoinedString=function(separator,selector){return null==separator&&(separator=""),null==selector&&(selector=Functions.Identity),this.select(selector).toArray().join(separator)},Enumerable.prototype.doAction=function(action){var source=this;return action=Utils.createLambda(action),new Enumerable(function(){var enumerator,index=0;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return!!enumerator.moveNext()&&(action(enumerator.current(),index++),this.yieldReturn(enumerator.current()))},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.forEach=function(action){action=Utils.createLambda(action);var index=0,enumerator=this.getEnumerator();try{for(;enumerator.moveNext()&&!1!==action(enumerator.current(),index++););}finally{Utils.dispose(enumerator)}},Enumerable.prototype.write=function(separator,selector){null==separator&&(separator=""),selector=Utils.createLambda(selector);var isFirst=!0;this.forEach(function(item){isFirst?isFirst=!1:document.write(separator),document.write(selector(item))})},Enumerable.prototype.writeLine=function(selector){selector=Utils.createLambda(selector),this.forEach(function(item){document.writeln(selector(item)+"<br />")})},Enumerable.prototype.force=function(){var enumerator=this.getEnumerator();try{for(;enumerator.moveNext(););}finally{Utils.dispose(enumerator)}},Enumerable.prototype.letBind=function(func){func=Utils.createLambda(func);var source=this;return new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=Enumerable.from(func(source)).getEnumerator()},function(){return!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.share=function(){var sharedEnumerator,source=this,disposed=!1;return new DisposableEnumerable(function(){return new IEnumerator(function(){null==sharedEnumerator&&(sharedEnumerator=source.getEnumerator())},function(){if(disposed)throw new Error("enumerator is disposed");return!!sharedEnumerator.moveNext()&&this.yieldReturn(sharedEnumerator.current())},Functions.Blank)},function(){disposed=!0,Utils.dispose(sharedEnumerator)})},Enumerable.prototype.memoize=function(){var cache,enumerator,source=this,disposed=!1;return new DisposableEnumerable(function(){var index=-1;return new IEnumerator(function(){null==enumerator&&(enumerator=source.getEnumerator(),cache=[])},function(){if(disposed)throw new Error("enumerator is disposed");return index++,cache.length<=index?!!enumerator.moveNext()&&this.yieldReturn(cache[index]=enumerator.current()):this.yieldReturn(cache[index])},Functions.Blank)},function(){disposed=!0,Utils.dispose(enumerator),cache=null})},Enumerable.prototype.catchError=function(handler){handler=Utils.createLambda(handler);var source=this;return new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){try{return!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())}catch(e){return handler(e),!1}},function(){Utils.dispose(enumerator)})})},Enumerable.prototype.finallyAction=function(finallyAction){finallyAction=Utils.createLambda(finallyAction);var source=this;return new Enumerable(function(){var enumerator;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){return!!enumerator.moveNext()&&this.yieldReturn(enumerator.current())},function(){try{Utils.dispose(enumerator)}finally{finallyAction()}})})},Enumerable.prototype.log=function(selector){return selector=Utils.createLambda(selector),this.doAction(function(item){})},Enumerable.prototype.trace=function(message,selector){return null==message&&(message="Trace"),selector=Utils.createLambda(selector),this.doAction(function(item){})};var OrderedEnumerable=function(source,keySelector,descending,parent){this.source=source,this.keySelector=Utils.createLambda(keySelector),this.descending=descending,this.parent=parent};OrderedEnumerable.prototype=new Enumerable,OrderedEnumerable.prototype.createOrderedEnumerable=function(keySelector,descending){return new OrderedEnumerable(this.source,keySelector,descending,this)},OrderedEnumerable.prototype.thenBy=function(keySelector){return this.createOrderedEnumerable(keySelector,!1)},OrderedEnumerable.prototype.thenByDescending=function(keySelector){return this.createOrderedEnumerable(keySelector,!0)},OrderedEnumerable.prototype.getEnumerator=function(){var buffer,indexes,self=this,index=0;return new IEnumerator(function(){buffer=[],indexes=[],self.source.forEach(function(item,index){buffer.push(item),indexes.push(index)});var sortContext=SortContext.create(self,null);sortContext.GenerateKeys(buffer),indexes.sort(function(a,b){return sortContext.compare(a,b)})},function(){return index<indexes.length&&this.yieldReturn(buffer[indexes[index++]])},Functions.Blank)};var SortContext=function(keySelector,descending,child){this.keySelector=keySelector,this.descending=descending,this.child=child,this.keys=null};SortContext.create=function(orderedEnumerable,currentContext){var context=new SortContext(orderedEnumerable.keySelector,orderedEnumerable.descending,currentContext);return null!=orderedEnumerable.parent?SortContext.create(orderedEnumerable.parent,context):context},SortContext.prototype.GenerateKeys=function(source){for(var len=source.length,keySelector=this.keySelector,keys=new Array(len),i=0;i<len;i++)keys[i]=keySelector(source[i]);this.keys=keys,null!=this.child&&this.child.GenerateKeys(source)},SortContext.prototype.compare=function(index1,index2){var comparison=Utils.compare(this.keys[index1],this.keys[index2]);return 0==comparison?null!=this.child?this.child.compare(index1,index2):Utils.compare(index1,index2):this.descending?-comparison:comparison};var DisposableEnumerable=function(getEnumerator,dispose){this.dispose=dispose,Enumerable.call(this,getEnumerator)};DisposableEnumerable.prototype=new Enumerable;var ArrayEnumerable=function(source){this.getSource=function(){return source}};ArrayEnumerable.prototype=new Enumerable,ArrayEnumerable.prototype.any=function(predicate){return null==predicate?0<this.getSource().length:Enumerable.prototype.any.apply(this,arguments)},ArrayEnumerable.prototype.count=function(predicate){return null==predicate?this.getSource().length:Enumerable.prototype.count.apply(this,arguments)},ArrayEnumerable.prototype.elementAt=function(index){var source=this.getSource();return 0<=index&&index<source.length?source[index]:Enumerable.prototype.elementAt.apply(this,arguments)},ArrayEnumerable.prototype.elementAtOrDefault=function(index,defaultValue){void 0===defaultValue&&(defaultValue=null);var source=this.getSource();return 0<=index&&index<source.length?source[index]:defaultValue},ArrayEnumerable.prototype.first=function(predicate){var source=this.getSource();return null==predicate&&0<source.length?source[0]:Enumerable.prototype.first.apply(this,arguments)},ArrayEnumerable.prototype.firstOrDefault=function(predicate,defaultValue){if(void 0!==predicate)return Enumerable.prototype.firstOrDefault.apply(this,arguments);defaultValue=predicate;var source=this.getSource();return 0<source.length?source[0]:defaultValue},ArrayEnumerable.prototype.last=function(predicate){var source=this.getSource();return null==predicate&&0<source.length?source[source.length-1]:Enumerable.prototype.last.apply(this,arguments)},ArrayEnumerable.prototype.lastOrDefault=function(predicate,defaultValue){if(void 0!==predicate)return Enumerable.prototype.lastOrDefault.apply(this,arguments);defaultValue=predicate;var source=this.getSource();return 0<source.length?source[source.length-1]:defaultValue},ArrayEnumerable.prototype.skip=function(count){var source=this.getSource();return new Enumerable(function(){var index;return new IEnumerator(function(){index=count<0?0:count},function(){return index<source.length&&this.yieldReturn(source[index++])},Functions.Blank)})},ArrayEnumerable.prototype.takeExceptLast=function(count){return null==count&&(count=1),this.take(this.getSource().length-count)},ArrayEnumerable.prototype.takeFromLast=function(count){return this.skip(this.getSource().length-count)},ArrayEnumerable.prototype.reverse=function(){var source=this.getSource();return new Enumerable(function(){var index;return new IEnumerator(function(){index=source.length},function(){return 0<index&&this.yieldReturn(source[--index])},Functions.Blank)})},ArrayEnumerable.prototype.sequenceEqual=function(second,compareSelector){return(!(second instanceof ArrayEnumerable||second instanceof Array)||null!=compareSelector||Enumerable.from(second).count()==this.count())&&Enumerable.prototype.sequenceEqual.apply(this,arguments)},ArrayEnumerable.prototype.toJoinedString=function(separator,selector){var source=this.getSource();return null==selector&&source instanceof Array?(null==separator&&(separator=""),source.join(separator)):Enumerable.prototype.toJoinedString.apply(this,arguments)},ArrayEnumerable.prototype.getEnumerator=function(){var source=this.getSource(),index=-1;return{current:function(){return source[index]},moveNext:function(){return++index<source.length},dispose:Functions.Blank}};var WhereEnumerable=function(source,predicate){this.prevSource=source,this.prevPredicate=predicate};WhereEnumerable.prototype=new Enumerable,WhereEnumerable.prototype.where=function(predicate){if((predicate=Utils.createLambda(predicate)).length<=1){var prevPredicate=this.prevPredicate;return new WhereEnumerable(this.prevSource,function(x){return prevPredicate(x)&&predicate(x)})}return Enumerable.prototype.where.call(this,predicate)},WhereEnumerable.prototype.select=function(selector){return(selector=Utils.createLambda(selector)).length<=1?new WhereSelectEnumerable(this.prevSource,this.prevPredicate,selector):Enumerable.prototype.select.call(this,selector)},WhereEnumerable.prototype.getEnumerator=function(){var enumerator,predicate=this.prevPredicate,source=this.prevSource;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();)if(predicate(enumerator.current()))return this.yieldReturn(enumerator.current());return!1},function(){Utils.dispose(enumerator)})};var WhereSelectEnumerable=function(source,predicate,selector){this.prevSource=source,this.prevPredicate=predicate,this.prevSelector=selector};WhereSelectEnumerable.prototype=new Enumerable,WhereSelectEnumerable.prototype.where=function(predicate){return(predicate=Utils.createLambda(predicate)).length<=1?new WhereEnumerable(this,predicate):Enumerable.prototype.where.call(this,predicate)},WhereSelectEnumerable.prototype.select=function(selector){if((selector=Utils.createLambda(selector)).length<=1){var prevSelector=this.prevSelector;return new WhereSelectEnumerable(this.prevSource,this.prevPredicate,function(x){return selector(prevSelector(x))})}return Enumerable.prototype.select.call(this,selector)},WhereSelectEnumerable.prototype.getEnumerator=function(){var enumerator,predicate=this.prevPredicate,selector=this.prevSelector,source=this.prevSource;return new IEnumerator(function(){enumerator=source.getEnumerator()},function(){for(;enumerator.moveNext();)if(null==predicate||predicate(enumerator.current()))return this.yieldReturn(selector(enumerator.current()));return!1},function(){Utils.dispose(enumerator)})};var Dictionary=function(){var callHasOwnProperty=function(target,key){return Object.prototype.hasOwnProperty.call(target,key)},computeHashCode=function(obj){return null===obj?"null":void 0===obj?"undefined":typeof obj.toString===Types_Function?obj.toString():Object.prototype.toString.call(obj)},HashEntry=function(key,value){this.key=key,this.value=value,this.prev=null,this.next=null},EntryList=function(){this.first=null,this.last=null};EntryList.prototype={addLast:function(entry){null!=this.last?((this.last.next=entry).prev=this.last,this.last=entry):this.first=this.last=entry},replace:function(entry,newEntry){null!=entry.prev?(entry.prev.next=newEntry).prev=entry.prev:this.first=newEntry,null!=entry.next?(entry.next.prev=newEntry).next=entry.next:this.last=newEntry},remove:function(entry){null!=entry.prev?entry.prev.next=entry.next:this.first=entry.next,null!=entry.next?entry.next.prev=entry.prev:this.last=entry.prev}};var Dictionary=function(compareSelector){this.countField=0,this.entryList=new EntryList,this.buckets={},this.compareSelector=null==compareSelector?Functions.Identity:compareSelector};return Dictionary.prototype={add:function(key,value){var compareKey=this.compareSelector(key),hash=computeHashCode(compareKey),entry=new HashEntry(key,value);if(callHasOwnProperty(this.buckets,hash)){for(var array=this.buckets[hash],i=0;i<array.length;i++)if(this.compareSelector(array[i].key)===compareKey)return this.entryList.replace(array[i],entry),void(array[i]=entry);array.push(entry)}else this.buckets[hash]=[entry];this.countField++,this.entryList.addLast(entry)},get:function(key){var compareKey=this.compareSelector(key),hash=computeHashCode(compareKey);if(callHasOwnProperty(this.buckets,hash))for(var array=this.buckets[hash],i=0;i<array.length;i++){var entry=array[i];if(this.compareSelector(entry.key)===compareKey)return entry.value}},set:function(key,value){var compareKey=this.compareSelector(key),hash=computeHashCode(compareKey);if(callHasOwnProperty(this.buckets,hash))for(var array=this.buckets[hash],i=0;i<array.length;i++)if(this.compareSelector(array[i].key)===compareKey){var newEntry=new HashEntry(key,value);return this.entryList.replace(array[i],newEntry),array[i]=newEntry,!0}return!1},contains:function(key){var compareKey=this.compareSelector(key),hash=computeHashCode(compareKey);if(!callHasOwnProperty(this.buckets,hash))return!1;for(var array=this.buckets[hash],i=0;i<array.length;i++)if(this.compareSelector(array[i].key)===compareKey)return!0;return!1},clear:function(){this.countField=0,this.buckets={},this.entryList=new EntryList},remove:function(key){var compareKey=this.compareSelector(key),hash=computeHashCode(compareKey);if(callHasOwnProperty(this.buckets,hash))for(var array=this.buckets[hash],i=0;i<array.length;i++)if(this.compareSelector(array[i].key)===compareKey)return this.entryList.remove(array[i]),array.splice(i,1),0==array.length&&delete this.buckets[hash],void this.countField--},count:function(){return this.countField},toEnumerable:function(){var self=this;return new Enumerable(function(){var currentEntry;return new IEnumerator(function(){currentEntry=self.entryList.first},function(){if(null!=currentEntry){var result={key:currentEntry.key,value:currentEntry.value};return currentEntry=currentEntry.next,this.yieldReturn(result)}return!1},Functions.Blank)})}},Dictionary}(),Lookup=function(dictionary){this.count=function(){return dictionary.count()},this.get=function(key){return Enumerable.from(dictionary.get(key))},this.contains=function(key){return dictionary.contains(key)},this.toEnumerable=function(){return dictionary.toEnumerable().select(function(kvp){return new Grouping(kvp.key,kvp.value)})}},Grouping=function(groupKey,elements){this.key=function(){return groupKey},ArrayEnumerable.call(this,elements)};Grouping.prototype=new ArrayEnumerable,typeof define===Types_Function&&define.amd?define("linqjs",[],function(){return Enumerable}):typeof module!==Types_Undefined&&module.exports?module.exports=Enumerable:root.Enumerable=Enumerable}(this);