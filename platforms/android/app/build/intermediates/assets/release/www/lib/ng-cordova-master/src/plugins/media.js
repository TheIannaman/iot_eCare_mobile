angular.module("ngCordova.plugins.media",[]).service("NewMedia",["$q","$interval",function($q,$interval){var q,q2,q3,mediaTimer,mediaStatus=null,mediaPosition=-1,mediaDuration=-1;function clearTimer(){angular.isDefined(mediaTimer)&&($interval.cancel(mediaTimer),mediaTimer=void 0)}function resetValues(){mediaDuration=mediaPosition=-1}function NewMedia(src){this.media=new Media(src,function(success){clearTimer(),resetValues(),q.resolve(success)},function(error){clearTimer(),resetValues(),q.reject(error)},function(status){mediaStatus=status,q.notify({status:mediaStatus})})}return NewMedia.prototype.play=function(options){var media;return q=$q.defer(),"object"!=typeof options&&(options={}),this.media.play(options),media=this.media,angular.isDefined(mediaTimer)||(mediaTimer=$interval(function(){mediaDuration<0&&(mediaDuration=media.getDuration(),q&&0<mediaDuration&&q.notify({duration:mediaDuration})),media.getCurrentPosition(function(position){-1<position&&(mediaPosition=position)},function(e){}),q&&q.notify({position:mediaPosition})},1e3)),q.promise},NewMedia.prototype.pause=function(){clearTimer(),this.media.pause()},NewMedia.prototype.stop=function(){this.media.stop()},NewMedia.prototype.release=function(){this.media.release(),this.media=void 0},NewMedia.prototype.seekTo=function(timing){this.media.seekTo(timing)},NewMedia.prototype.setVolume=function(volume){this.media.setVolume(volume)},NewMedia.prototype.startRecord=function(){this.media.startRecord()},NewMedia.prototype.stopRecord=function(){this.media.stopRecord()},NewMedia.prototype.currentTime=function(){return q2=$q.defer(),this.media.getCurrentPosition(function(position){q2.resolve(position)}),q2.promise},NewMedia.prototype.getDuration=function(){return q3=$q.defer(),this.media.getDuration(function(duration){q3.resolve(duration)}),q3.promise},NewMedia}]).factory("$cordovaMedia",["NewMedia",function(NewMedia){return{newMedia:function(src){return new NewMedia(src)}}}]);